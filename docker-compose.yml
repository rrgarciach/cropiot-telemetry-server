version: '3'

volumes:

  dynamodb_data:

services:

  telemetry-server:
    container_name: telemetry-server
    restart: on-failure
    build: .
    command: yarn start
    env_file: .env
    volumes:
      - .:/home/node/app/
      - /home/node/app/node_modules/
    ports:
      - 1883:1883
#    depends_on:
#      - telemetry-server-dynamodb
    environment:
      PORT: 1883
#      LOCAL_DYNAMODB_HOST: http://telemetry-server-dynamodb:8000
#    external_links:
#      - telemetry-server-dynamodb
    network_mode: bridge

#  telemetry-server-dynamodb:
#    container_name: telemetry-server-dynamodb
#    image: amazon/dynamodb-local
#    restart: on-failure
#    command: -jar DynamoDBLocal.jar -sharedDb -dbPath /home/dynamodblocal
#    volumes:
#      - dynamodb_data:/home/dynamodblocal
#    ports:
#      - 8042:8000
#    network_mode: bridge
